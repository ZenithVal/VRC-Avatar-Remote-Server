(function(){"use strict";var a={73677:function(a,t,r){var e=r(49242),n=r(73396),o=r(87139);const d={key:1},s=(0,n.Uk)("VRC Remote Admin"),l=(0,n.Uk)("Create board"),i=(0,n._)("div",{class:"spacer"},null,-1),u=(0,n.Uk)("You can open this board under this url: "),p=(0,n.Uk)("Rename board"),c=(0,n._)("div",{class:"spacer"},null,-1),h=(0,n.Uk)("Set password"),m=(0,n.Uk)("Disable password"),w=(0,n.Uk)("Drop an avatar OSC JSON file to add it to the board or to update its parameters. You can find these JSON files in a subdirectory of this path (click to select and copy-paste into Windows Explorer):"),v={key:0},f=(0,n._)("b",null,"Error while adding avatar",-1),g=(0,n.Uk)(" Found avatar "),b=(0,n.Uk)(" with "),y=(0,n.Uk)(" input parameters. "),A=(0,n.Uk)("Add avatar"),k=(0,n._)("div",{class:"spacer"},null,-1),B=(0,n.Uk)("Add parameter control"),S=(0,n._)("div",{class:"spacer"},null,-1);function _(a,t,r,e,_,D){const W=(0,n.up)("Login"),O=(0,n.up)("n-h1"),U=(0,n.up)("n-button"),x=(0,n.up)("n-text"),P=(0,n.up)("n-card"),C=(0,n.up)("n-collapse-item"),j=(0,n.up)("n-collapse"),z=(0,n.up)("n-divider"),L=(0,n.up)("n-select"),F=(0,n.up)("n-a"),M=(0,n.up)("n-input"),$=(0,n.up)("n-form-item"),E=(0,n.up)("n-form"),I=(0,n.up)("Dropzone"),T=(0,n.up)("n-config-provider");return(0,n.wg)(),(0,n.iD)("main",null,[a.loggedIn?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(T,{theme:_.darkTheme},{default:(0,n.w5)((()=>[(0,n.Wm)(O,null,{default:(0,n.w5)((()=>[s])),_:1}),(0,n.Wm)(j,null,{default:(0,n.w5)((()=>[(0,n.Wm)(C,{title:"Add board"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,null,{default:(0,n.w5)((()=>[(0,n.Wm)(U,{type:"primary",onClick:D.addBoard},{default:(0,n.w5)((()=>[l])),_:1},8,["onClick"]),_.addBoardStatus.show?((0,n.wg)(),(0,n.j4)(x,{key:0,type:_.addBoardStatus.error?"error":"info",style:{"margin-left":"10px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(_.addBoardStatus.error?_.addBoardStatus.error:_.addBoardStatus.text),1)])),_:1},8,["type"])):(0,n.kq)("",!0)])),_:1})])),_:1})])),_:1}),(0,n.Wm)(z),(0,n.Wm)(L,{"on-update:value":D.changeBoard,options:D.boardSelectOptions,placeholder:"Select board"},null,8,["on-update:value","options"]),i,null!==_.currentBoard?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[u,(0,n.Wm)(F,{href:D.boardUrl,target:"_blank"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(D.boardUrl),1)])),_:1},8,["href"])])),_:1}),(0,n.Wm)(z),(0,n.Wm)(j,{style:{"margin-bottom":"20px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(C,{title:"Rename board"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,null,{default:(0,n.w5)((()=>[(0,n.Wm)(E,null,{default:(0,n.w5)((()=>[(0,n.Wm)($,{label:"Rename board"},{default:(0,n.w5)((()=>[(0,n.Wm)(M,{value:_.currentBoardData.name,"onUpdate:value":t[1]||(t[1]=a=>_.currentBoardData.name=a),placeholder:"Board name"},null,8,["value"])])),_:1})])),_:1}),(0,n.Wm)(U,{disabled:_.boards[_.currentBoard].name==_.currentBoardData.name,onClick:D.renameBoard},{default:(0,n.w5)((()=>[p])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),(0,n.Wm)(C,{title:"Board password"},{default:(0,n.w5)((()=>[(0,n.Wm)(P,null,{default:(0,n.w5)((()=>[(0,n.Wm)(E,null,{default:(0,n.w5)((()=>[(0,n.Wm)($,{label:"Password"},{default:(0,n.w5)((()=>[(0,n.Wm)(M,{value:_.currentBoardData.newPassword,"onUpdate:value":t[2]||(t[2]=a=>_.currentBoardData.newPassword=a),placeholder:"Board password"},null,8,["value"])])),_:1})])),_:1}),(0,n.Wm)(x,{type:_.boards[_.currentBoard].password?"success":"info"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(_.boards[_.currentBoard].password?"Password is currently set":"Password is currently not set"),1)])),_:1},8,["type"]),c,(0,n.Wm)(U,{disabled:0==_.currentBoardData.newPassword.length,onClick:t[3]||(t[3]=a=>D.setBoardPassword(_.currentBoardData.newPassword)),style:{"margin-right":"10px"}},{default:(0,n.w5)((()=>[h])),_:1},8,["disabled"]),(0,n.Wm)(U,{type:"warning",disabled:!_.boards[_.currentBoard].password,onClick:t[4]||(t[4]=a=>D.setBoardPassword(null))},{default:(0,n.w5)((()=>[m])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,n.Wm)(P,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[w])),_:1}),(0,n.Wm)(M,{readonly:"",size:"small",value:"%HOMEPATH%\\AppData\\LocalLow\\VRChat\\VRChat\\OSC",ref:"oscPathInput",onClick:t[5]||(t[5]=t=>a.$refs.oscPathInput.select())},null,512),(0,n.Wm)(I,{onFile:D.openAvatarFile},null,8,["onFile"]),null!==_.droppedAvatar?((0,n.wg)(),(0,n.iD)("div",v,[null!==_.droppedAvatar.error?((0,n.wg)(),(0,n.j4)(x,{key:0,type:"error"},{default:(0,n.w5)((()=>[f,(0,n.Uk)(": "+(0,o.zw)(_.droppedAvatar.error),1)])),_:1})):null!==D.processedAvatarData?((0,n.wg)(),(0,n.j4)(x,{key:1,type:"info"},{default:(0,n.w5)((()=>[g,(0,n._)("b",null,(0,o.zw)(D.processedAvatarData.name),1),b,(0,n._)("b",null,(0,o.zw)(D.processedAvatarData.parameters.length),1),y])),_:1})):(0,n.kq)("",!0)])):(0,n.kq)("",!0),D.canAddAvatar?((0,n.wg)(),(0,n.j4)(U,{key:1,type:"primary",onClick:D.addAvatar,style:{"margin-top":"20px"}},{default:(0,n.w5)((()=>[A])),_:1},8,["onClick"])):(0,n.kq)("",!0),_.addAvatarStatus.show?((0,n.wg)(),(0,n.j4)(x,{key:2,type:_.addAvatarStatus.error?"error":"info",style:{"margin-left":"10px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(_.addAvatarStatus.error?_.addAvatarStatus.error:_.addAvatarStatus.text),1)])),_:1},8,["type"])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(z),(0,n.Wm)(L,{"on-update:value":D.changeAvatar,options:D.avatarSelectOptions,placeholder:"Select avatar"},null,8,["on-update:value","options"]),null!==_.currentAvatar?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[k,null!==D.processedAvatarData&&_.currentAvatar==D.processedAvatarData.id?((0,n.wg)(),(0,n.j4)(P,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(E),(0,n.Wm)(U,{type:"primary"},{default:(0,n.w5)((()=>[B])),_:1})])),_:1})):(0,n.kq)("",!0)],64)):(0,n.kq)("",!0),S],64)):(0,n.kq)("",!0)])),_:1},8,["theme"])])):((0,n.wg)(),(0,n.j4)(W,{key:0,onAttemptLogin:t[0]||(t[0]=t=>a.performLogin("admin",t)),errorMessage:a.loginError},null,8,["errorMessage"]))])}var D=r(56265),W=r.n(D),O=r(79652),U={data(){return{loggedIn:!1,notFound:!1,loginError:null}},methods:{async checkLogin(a){try{const t=await W().get(`/api/login/${a}`);this.loggedIn=t.data.loggedIn}catch(t){404==t.response.status&&(this.notFound=!0)}},async performLogin(a,t){this.loginError=null;try{const r=await W().post(`/api/login/${a}`,{password:t});this.loggedIn=this.loggedIn||r.data.success,r.data.success||(this.loginError="Login failed (Wrong password)")}catch(r){console.log(r.response)}},getPasswordParam(){const a=new URLSearchParams(window.location.search);return a.get("password")}}};const x=a=>((0,n.dD)("data-v-902ad498"),a=a(),(0,n.Cn)(),a),P={class:"basic-box login-box"},C=x((()=>(0,n._)("h1",null,"Login",-1))),j={key:0,class:"error"},z=x((()=>(0,n._)("button",{class:"button green small login-button"},"Login",-1)));function L(a,t,r,d,s,l){return(0,n.wg)(),(0,n.iD)("div",P,[C,(0,n._)("form",{onSubmit:t[1]||(t[1]=(0,e.iM)((t=>a.$emit("attempt-login",s.password)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=a=>s.password=a),class:"password-input",placeholder:"Password"},null,512),[[e.nr,s.password]]),null!=r.errorMessage?((0,n.wg)(),(0,n.iD)("div",j,(0,o.zw)(r.errorMessage),1)):(0,n.kq)("",!0),z],32)])}var F={name:"LoginComponent",props:["errorMessage"],data(){return{password:""}}},M=r(40089);const $=(0,M.Z)(F,[["render",L],["__scopeId","data-v-902ad498"]]);var E=$;const I={class:"title"};function T(a,t,r,d,s,l){return(0,n.wg)(),(0,n.iD)("div",{class:"dropzone",onDrop:t[0]||(t[0]=(0,e.iM)(((...a)=>l.handleDrop&&l.handleDrop(...a)),["prevent"])),onDragover:t[1]||(t[1]=(0,e.iM)((()=>{}),["prevent"]))},[(0,n._)("div",I,(0,o.zw)(s.droppedFilename),1)],32)}var q={name:"DropzoneComponent",data(){return{droppedFilename:"Drop a file here"}},methods:{handleDrop(a){const t=a.dataTransfer.files;t.length>0&&(this.droppedFilename=t[0].name,this.$emit("file",t[0]))}}};const R=(0,M.Z)(q,[["render",T]]);var N=R,J={mixins:[U],components:{Login:E,Dropzone:N},data(){return{darkTheme:O.$,newBoardName:"",boards:null,currentBoard:null,currentBoardData:{},currentAvatar:null,droppedAvatar:null,addAvatarStatus:{show:!1,error:null,text:null},addBoardStatus:{show:!1,error:null,text:null},currentParameterControl:{}}},watch:{async loggedIn(a){a&&await this.updateBoards()}},computed:{boardSelectOptions(){return null==this.boards?[]:Object.entries(this.boards).map((a=>({label:a[1].name,value:a[0]})))},avatarSelectOptions(){return null==this.boards||null==this.currentBoard?[]:Object.entries(this.boards[this.currentBoard].avatars).map((a=>({label:a[1].name,value:a[0]})))},canAddAvatar(){return null!==this.droppedAvatar&&null!==this.droppedAvatar.data&&null!==this.boards&&null!==this.currentBoard&&!(this.droppedAvatar.data.id in this.boards[this.currentBoard].avatars)},processedAvatarData(){return null==this.droppedAvatar||null==this.droppedAvatar.data?null:{name:this.droppedAvatar.data.name,id:this.droppedAvatar.data.id,parameters:this.droppedAvatar.data.parameters.filter((a=>"input"in a)).map((a=>({name:a.name,type:a.input.type})))}},boardUrl(){return null==this.boards||null==this.currentBoard?"":`${window.location.origin}/b/${this.currentBoard}`}},methods:{async updateBoards(){const a=await W().get("/api/admin/boards");this.boards=a.data.boards},changeBoard(a){this.currentBoard=a,this.currentBoardData=Object.assign({newPassword:""},this.boards[a]),this.currentAvatar=null},changeAvatar(a){this.currentAvatar=a},openAvatarFile(a){if(this.droppedAvatar={error:null,data:null},"application/json"!=a.type)return void(this.droppedAvatar.error="The dropped file is not a JSON file");const t=new FileReader;t.onload=a=>{try{this.droppedAvatar.data=JSON.parse(a.target.result)}catch(t){this.droppedAvatar.error="Could not parse JSON"}},t.readAsText(a)},addAvatar(){this.addAvatarStatus.show=!1,this.addAvatarStatus.error=null,this.addAvatarStatus.text=null,W().post(`/api/admin/b/${this.currentBoard}/add-avatar`,{avatar:{id:this.droppedAvatar.data.id,name:this.droppedAvatar.data.name}}).then((a=>(this.addAvatarStatus.show=!0,this.addAvatarStatus.text="Successfully added avatar",this.updateBoards()))).catch((a=>{this.addAvatarStatus.show=!0,this.addAvatarStatus.error="Error while adding avatar"}))},addBoard(){this.addBoardStatus.show=!1,this.addBoardStatus.error=null,this.addBoardStatus.text=null,W().post("/api/admin/create-board").then((a=>(this.addBoardStatus.show=!0,this.addBoardStatus.text=`Successfully created board ${a.data.board.name}`,this.updateBoards()))).catch((a=>{this.addBoardStatus.show=!0,this.addBoardStatus.error="Error while creating board"}))},renameBoard(){W().put(`/api/admin/b/${this.currentBoard}/name`,{name:this.currentBoardData.name}).then((a=>this.updateBoards())).catch((a=>{}))},setBoardPassword(a){W().put(`/api/admin/b/${this.currentBoard}/password`,{password:a}).then((a=>this.updateBoards())).catch((a=>{}))}},async created(){await this.checkLogin("admin")}};const H=(0,M.Z)(J,[["render",_]]);var V=H,Y=r(92156);const Z=(0,e.ri)(V);Z.use(Y.Z),Z.mount("#app")}},t={};function r(e){var n=t[e];if(void 0!==n)return n.exports;var o=t[e]={exports:{}};return a[e](o,o.exports,r),o.exports}r.m=a,function(){var a=[];r.O=function(t,e,n,o){if(!e){var d=1/0;for(u=0;u<a.length;u++){e=a[u][0],n=a[u][1],o=a[u][2];for(var s=!0,l=0;l<e.length;l++)(!1&o||d>=o)&&Object.keys(r.O).every((function(a){return r.O[a](e[l])}))?e.splice(l--,1):(s=!1,o<d&&(d=o));if(s){a.splice(u--,1);var i=n();void 0!==i&&(t=i)}}return t}o=o||0;for(var u=a.length;u>0&&a[u-1][2]>o;u--)a[u]=a[u-1];a[u]=[e,n,o]}}(),function(){r.n=function(a){var t=a&&a.__esModule?function(){return a["default"]}:function(){return a};return r.d(t,{a:t}),t}}(),function(){r.d=function(a,t){for(var e in t)r.o(t,e)&&!r.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:t[e]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()}(),function(){r.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)}}(),function(){r.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}(),function(){r.j=328}(),function(){var a={328:0};r.O.j=function(t){return 0===a[t]};var t=function(t,e){var n,o,d=e[0],s=e[1],l=e[2],i=0;if(d.some((function(t){return 0!==a[t]}))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(l)var u=l(r)}for(t&&t(e);i<d.length;i++)o=d[i],r.o(a,o)&&a[o]&&a[o][0](),a[o]=0;return r.O(u)},e=self["webpackChunkclient"]=self["webpackChunkclient"]||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}();var e=r.O(void 0,[998],(function(){return r(73677)}));e=r.O(e)})();
//# sourceMappingURL=admin.c361857e.js.map