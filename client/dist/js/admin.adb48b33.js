(function(){"use strict";var a={74786:function(a,t,r){var e=r(49242),n=r(73396),o=r(87139);const d={key:1},s=(0,n.Uk)("VRC Remote Admin"),l=(0,n.Uk)("Create board"),i=(0,n._)("div",{class:"spacer"},null,-1),u=(0,n.Uk)("Rename board"),p=(0,n._)("div",{class:"spacer"},null,-1),c=(0,n.Uk)("Set password"),h=(0,n.Uk)("Disable password"),m=(0,n.Uk)("Drop an avatar OSC JSON file to add it to the board or to update its parameters:"),v={key:0},w=(0,n._)("b",null,"Error while adding avatar",-1),f=(0,n.Uk)(" Found avatar "),g=(0,n.Uk)(" with "),b=(0,n.Uk)(" input parameters. "),y=(0,n.Uk)("Add avatar"),A=(0,n._)("div",{class:"spacer"},null,-1),B=(0,n.Uk)("Add parameter control"),k=(0,n._)("div",{class:"spacer"},null,-1);function S(a,t,r,e,S,_){const D=(0,n.up)("Login"),W=(0,n.up)("n-h1"),O=(0,n.up)("n-button"),x=(0,n.up)("n-text"),j=(0,n.up)("n-card"),P=(0,n.up)("n-collapse-item"),U=(0,n.up)("n-collapse"),C=(0,n.up)("n-divider"),z=(0,n.up)("n-select"),F=(0,n.up)("n-input"),L=(0,n.up)("n-form-item"),M=(0,n.up)("n-form"),q=(0,n.up)("Dropzone"),T=(0,n.up)("n-config-provider");return(0,n.wg)(),(0,n.iD)("main",null,[a.loggedIn?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(T,{theme:S.darkTheme},{default:(0,n.w5)((()=>[(0,n.Wm)(W,null,{default:(0,n.w5)((()=>[s])),_:1}),(0,n.Wm)(U,null,{default:(0,n.w5)((()=>[(0,n.Wm)(P,{title:"Add board"},{default:(0,n.w5)((()=>[(0,n.Wm)(j,null,{default:(0,n.w5)((()=>[(0,n.Wm)(O,{type:"primary",onClick:_.addBoard},{default:(0,n.w5)((()=>[l])),_:1},8,["onClick"]),S.addBoardStatus.show?((0,n.wg)(),(0,n.j4)(x,{key:0,type:S.addBoardStatus.error?"error":"info",style:{"margin-left":"10px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(S.addBoardStatus.error?S.addBoardStatus.error:S.addBoardStatus.text),1)])),_:1},8,["type"])):(0,n.kq)("",!0)])),_:1})])),_:1})])),_:1}),(0,n.Wm)(C),(0,n.Wm)(z,{"on-update:value":_.changeBoard,options:_.boardSelectOptions,placeholder:"Select board"},null,8,["on-update:value","options"]),i,null!==S.currentBoard?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[(0,n.Wm)(U,{style:{"margin-bottom":"20px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(P,{title:"Rename board"},{default:(0,n.w5)((()=>[(0,n.Wm)(j,null,{default:(0,n.w5)((()=>[(0,n.Wm)(M,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L,{label:"Rename board"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{value:S.currentBoardData.name,"onUpdate:value":t[1]||(t[1]=a=>S.currentBoardData.name=a),placeholder:"Board name"},null,8,["value"])])),_:1})])),_:1}),(0,n.Wm)(O,{disabled:S.boards[S.currentBoard].name==S.currentBoardData.name,onClick:_.renameBoard},{default:(0,n.w5)((()=>[u])),_:1},8,["disabled","onClick"])])),_:1})])),_:1}),(0,n.Wm)(P,{title:"Board password"},{default:(0,n.w5)((()=>[(0,n.Wm)(j,null,{default:(0,n.w5)((()=>[(0,n.Wm)(M,null,{default:(0,n.w5)((()=>[(0,n.Wm)(L,{label:"Password"},{default:(0,n.w5)((()=>[(0,n.Wm)(F,{value:S.currentBoardData.newPassword,"onUpdate:value":t[2]||(t[2]=a=>S.currentBoardData.newPassword=a),placeholder:"Board password"},null,8,["value"])])),_:1})])),_:1}),(0,n.Wm)(x,{type:S.boards[S.currentBoard].password?"success":"info"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(S.boards[S.currentBoard].password?"Password is currently set":"Password is currently not set"),1)])),_:1},8,["type"]),p,(0,n.Wm)(O,{disabled:0==S.currentBoardData.newPassword.length,onClick:t[3]||(t[3]=a=>_.setBoardPassword(S.currentBoardData.newPassword)),style:{"margin-right":"10px"}},{default:(0,n.w5)((()=>[c])),_:1},8,["disabled"]),(0,n.Wm)(O,{type:"warning",disabled:!S.boards[S.currentBoard].password,onClick:t[4]||(t[4]=a=>_.setBoardPassword(null))},{default:(0,n.w5)((()=>[h])),_:1},8,["disabled"])])),_:1})])),_:1})])),_:1}),(0,n.Wm)(j,null,{default:(0,n.w5)((()=>[(0,n.Wm)(x,null,{default:(0,n.w5)((()=>[m])),_:1}),(0,n.Wm)(q,{onFile:_.openAvatarFile},null,8,["onFile"]),null!==S.droppedAvatar?((0,n.wg)(),(0,n.iD)("div",v,[null!==S.droppedAvatar.error?((0,n.wg)(),(0,n.j4)(x,{key:0,type:"error"},{default:(0,n.w5)((()=>[w,(0,n.Uk)(": "+(0,o.zw)(S.droppedAvatar.error),1)])),_:1})):null!==_.processedAvatarData?((0,n.wg)(),(0,n.j4)(x,{key:1,type:"info"},{default:(0,n.w5)((()=>[f,(0,n._)("b",null,(0,o.zw)(_.processedAvatarData.name),1),g,(0,n._)("b",null,(0,o.zw)(_.processedAvatarData.parameters.length),1),b])),_:1})):(0,n.kq)("",!0)])):(0,n.kq)("",!0),_.canAddAvatar?((0,n.wg)(),(0,n.j4)(O,{key:1,type:"primary",onClick:_.addAvatar,style:{"margin-top":"20px"}},{default:(0,n.w5)((()=>[y])),_:1},8,["onClick"])):(0,n.kq)("",!0),S.addAvatarStatus.show?((0,n.wg)(),(0,n.j4)(x,{key:2,type:S.addAvatarStatus.error?"error":"info",style:{"margin-left":"10px"}},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(S.addAvatarStatus.error?S.addAvatarStatus.error:S.addAvatarStatus.text),1)])),_:1},8,["type"])):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(C),(0,n.Wm)(z,{"on-update:value":_.changeAvatar,options:_.avatarSelectOptions,placeholder:"Select avatar"},null,8,["on-update:value","options"]),null!==S.currentAvatar?((0,n.wg)(),(0,n.iD)(n.HY,{key:0},[A,null!==_.processedAvatarData&&S.currentAvatar==_.processedAvatarData.id?((0,n.wg)(),(0,n.j4)(j,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(M),(0,n.Wm)(O,{type:"primary"},{default:(0,n.w5)((()=>[B])),_:1})])),_:1})):(0,n.kq)("",!0)],64)):(0,n.kq)("",!0),k],64)):(0,n.kq)("",!0)])),_:1},8,["theme"])])):((0,n.wg)(),(0,n.j4)(D,{key:0,onAttemptLogin:t[0]||(t[0]=t=>a.performLogin("admin",t)),errorMessage:a.loginError},null,8,["errorMessage"]))])}var _=r(56265),D=r.n(_),W=r(79652),O={data(){return{loggedIn:!1,notFound:!1,loginError:null}},methods:{async checkLogin(a){try{const t=await D().get(`/api/login/${a}`);this.loggedIn=t.data.loggedIn}catch(t){404==t.response.status&&(this.notFound=!0)}},async performLogin(a,t){this.loginError=null;try{const r=await D().post(`/api/login/${a}`,{password:t});this.loggedIn=this.loggedIn||r.data.success,r.data.success||(this.loginError="Login failed (Wrong password)")}catch(r){console.log(r.response)}},getPasswordParam(){const a=new URLSearchParams(window.location.search);return a.get("password")}}};const x=a=>((0,n.dD)("data-v-902ad498"),a=a(),(0,n.Cn)(),a),j={class:"basic-box login-box"},P=x((()=>(0,n._)("h1",null,"Login",-1))),U={key:0,class:"error"},C=x((()=>(0,n._)("button",{class:"button green small login-button"},"Login",-1)));function z(a,t,r,d,s,l){return(0,n.wg)(),(0,n.iD)("div",j,[P,(0,n._)("form",{onSubmit:t[1]||(t[1]=(0,e.iM)((t=>a.$emit("attempt-login",s.password)),["prevent"]))},[(0,n.wy)((0,n._)("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=a=>s.password=a),class:"password-input",placeholder:"Password"},null,512),[[e.nr,s.password]]),null!=r.errorMessage?((0,n.wg)(),(0,n.iD)("div",U,(0,o.zw)(r.errorMessage),1)):(0,n.kq)("",!0),C],32)])}var F={name:"LoginComponent",props:["errorMessage"],data(){return{password:""}}},L=r(40089);const M=(0,L.Z)(F,[["render",z],["__scopeId","data-v-902ad498"]]);var q=M;const T={class:"title"};function $(a,t,r,d,s,l){return(0,n.wg)(),(0,n.iD)("div",{class:"dropzone",onDrop:t[0]||(t[0]=(0,e.iM)(((...a)=>l.handleDrop&&l.handleDrop(...a)),["prevent"])),onDragover:t[1]||(t[1]=(0,e.iM)((()=>{}),["prevent"]))},[(0,n._)("div",T,(0,o.zw)(s.droppedFilename),1)],32)}var E={name:"DropzoneComponent",data(){return{droppedFilename:"Drop a file here"}},methods:{handleDrop(a){const t=a.dataTransfer.files;t.length>0&&(this.droppedFilename=t[0].name,this.$emit("file",t[0]))}}};const I=(0,L.Z)(E,[["render",$]]);var R=I,N={mixins:[O],components:{Login:q,Dropzone:R},data(){return{darkTheme:W.$,newBoardName:"",boards:null,currentBoard:null,currentBoardData:{},currentAvatar:null,droppedAvatar:null,addAvatarStatus:{show:!1,error:null,text:null},addBoardStatus:{show:!1,error:null,text:null},currentParameterControl:{}}},watch:{async loggedIn(a){a&&await this.updateBoards()}},computed:{boardSelectOptions(){return null==this.boards?[]:Object.entries(this.boards).map((a=>({label:a[1].name,value:a[0]})))},avatarSelectOptions(){return null==this.boards||null==this.currentBoard?[]:Object.entries(this.boards[this.currentBoard].avatars).map((a=>({label:a[1].name,value:a[0]})))},canAddAvatar(){return null!==this.droppedAvatar&&null!==this.droppedAvatar.data&&null!==this.boards&&null!==this.currentBoard&&!(this.droppedAvatar.data.id in this.boards[this.currentBoard].avatars)},processedAvatarData(){return null==this.droppedAvatar||null==this.droppedAvatar.data?null:{name:this.droppedAvatar.data.name,id:this.droppedAvatar.data.id,parameters:this.droppedAvatar.data.parameters.filter((a=>"input"in a)).map((a=>({name:a.name,type:a.input.type})))}}},methods:{async updateBoards(){const a=await D().get("/api/admin/boards");this.boards=a.data.boards},changeBoard(a){this.currentBoard=a,this.currentBoardData=Object.assign({newPassword:""},this.boards[a]),this.currentAvatar=null},changeAvatar(a){this.currentAvatar=a},openAvatarFile(a){if(this.droppedAvatar={error:null,data:null},"application/json"!=a.type)return void(this.droppedAvatar.error="The dropped file is not a JSON file");const t=new FileReader;t.onload=a=>{try{this.droppedAvatar.data=JSON.parse(a.target.result)}catch(t){this.droppedAvatar.error="Could not parse JSON"}},t.readAsText(a)},addAvatar(){this.addAvatarStatus.show=!1,this.addAvatarStatus.error=null,this.addAvatarStatus.text=null,D().post(`/api/admin/b/${this.currentBoard}/add-avatar`,{avatar:{id:this.droppedAvatar.data.id,name:this.droppedAvatar.data.name}}).then((a=>(this.addAvatarStatus.show=!0,this.addAvatarStatus.text="Successfully added avatar",this.updateBoards()))).catch((a=>{this.addAvatarStatus.show=!0,this.addAvatarStatus.error="Error while adding avatar"}))},addBoard(){this.addBoardStatus.show=!1,this.addBoardStatus.error=null,this.addBoardStatus.text=null,D().post("/api/admin/create-board").then((a=>(this.addBoardStatus.show=!0,this.addBoardStatus.text=`Successfully created board ${a.data.board.name}`,this.updateBoards()))).catch((a=>{this.addBoardStatus.show=!0,this.addBoardStatus.error="Error while creating board"}))},renameBoard(){D().put(`/api/admin/b/${this.currentBoard}/name`,{name:this.currentBoardData.name}).then((a=>this.updateBoards())).catch((a=>{}))},setBoardPassword(a){D().put(`/api/admin/b/${this.currentBoard}/password`,{password:a}).then((a=>this.updateBoards())).catch((a=>{}))}},async created(){await this.checkLogin("admin")}};const J=(0,L.Z)(N,[["render",S]]);var Z=J,H=r(92156);const V=(0,e.ri)(Z);V.use(H.Z),V.mount("#app")}},t={};function r(e){var n=t[e];if(void 0!==n)return n.exports;var o=t[e]={exports:{}};return a[e](o,o.exports,r),o.exports}r.m=a,function(){var a=[];r.O=function(t,e,n,o){if(!e){var d=1/0;for(u=0;u<a.length;u++){e=a[u][0],n=a[u][1],o=a[u][2];for(var s=!0,l=0;l<e.length;l++)(!1&o||d>=o)&&Object.keys(r.O).every((function(a){return r.O[a](e[l])}))?e.splice(l--,1):(s=!1,o<d&&(d=o));if(s){a.splice(u--,1);var i=n();void 0!==i&&(t=i)}}return t}o=o||0;for(var u=a.length;u>0&&a[u-1][2]>o;u--)a[u]=a[u-1];a[u]=[e,n,o]}}(),function(){r.n=function(a){var t=a&&a.__esModule?function(){return a["default"]}:function(){return a};return r.d(t,{a:t}),t}}(),function(){r.d=function(a,t){for(var e in t)r.o(t,e)&&!r.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:t[e]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(a){if("object"===typeof window)return window}}()}(),function(){r.o=function(a,t){return Object.prototype.hasOwnProperty.call(a,t)}}(),function(){r.r=function(a){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}}(),function(){r.j=328}(),function(){var a={328:0};r.O.j=function(t){return 0===a[t]};var t=function(t,e){var n,o,d=e[0],s=e[1],l=e[2],i=0;if(d.some((function(t){return 0!==a[t]}))){for(n in s)r.o(s,n)&&(r.m[n]=s[n]);if(l)var u=l(r)}for(t&&t(e);i<d.length;i++)o=d[i],r.o(a,o)&&a[o]&&a[o][0](),a[o]=0;return r.O(u)},e=self["webpackChunkclient"]=self["webpackChunkclient"]||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}();var e=r.O(void 0,[998],(function(){return r(74786)}));e=r.O(e)})();
//# sourceMappingURL=admin.adb48b33.js.map